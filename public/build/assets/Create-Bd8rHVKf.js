import{W as g,j as e,Y as v,a as u,y}from"./app-DWiplGih.js";import{s as C}from"./SweetAlert-_wzJVbyC.js";import{A as _}from"./AuthenticatedLayout-RN_dLH_b.js";import"./jquery-TLgHKWof.js";import"./bootstrap.esm-Bb0rKlaf.js";import"./Loder-D9bdZO9o.js";import"./MyImage-BxCI3zcA.js";const I=({auth:h,errors:b,coupon:s})=>{const{errors:j,setError:i,clearErrors:c,data:l,setData:x,reset:f}=g({code:(s==null?void 0:s.code)||"",value:(s==null?void 0:s.value)||"",type:(s==null?void 0:s.type)||"1",usage_limit:(s==null?void 0:s.usage_limit)||"",exp_date:(s==null?void 0:s.exp_date)||"",status:(s==null?void 0:s.status)||1}),r={...b,...j},o=(n,a)=>{let t=!0;switch(n){case"code":!a||typeof a!="string"||a.length>255?(i("code","Coupon code is required and must be a string with a maximum length of 255 characters."),t=!1):c("code");break;case"value":isNaN(a)||a<0?(i("value","Coupon value must be a number greater than or equal to 0."),t=!1):c("value");break;case"type":["percent","fixed"].includes(a)?c("type"):(i("type","Coupon type must be either Percentage or Fixed."),t=!1);break;case"user_limit":isNaN(a)||a<0?(i("user_limit","User limit must be a number greater than or equal to 0."),t=!1):c("user_limit");break;case"exp_date":const m=new Date().toISOString().split("T")[0];!a||a<m?(i("exp_date","Expiration date must be today or later."),t=!1):c("exp_date");break;case"status":[1,2].includes(parseInt(a,10))?c("status"):(i("status","Status must be either Active or Inactive."),t=!1);break}return t},d=n=>{const{name:a,value:t}=n.target;x(a,t),o(a,t)},p=async n=>{if(n.preventDefault(),Object.keys(l).every(t=>o(t,l[t]))){const t=s?"Coupon updated successfully.":"Coupon created successfully.";await y.post(route("coupons.save",s==null?void 0:s.id),{...l},{onSuccess:()=>{C(t),s||f()}})}},N=()=>{let a="";const t="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";for(let m=0;m<10;m++)a+=t.charAt(Math.floor(Math.random()*t.length));x("code",a),o("code",a)};return e.jsxs(_,{user:h.user,children:[e.jsx(v,{title:s?"Edit Coupon":"Add Coupon"}),e.jsxs("div",{className:"card-box table-responsive",children:[e.jsx("nav",{"aria-label":"breadcrumb",children:e.jsxs("ol",{className:"breadcrumb text-primary",style:{justifyContent:"flex-end"},children:[e.jsx("li",{className:"breadcrumb-item",children:e.jsx(u,{href:route("admin.dashboard"),children:"Dashboard"})}),e.jsx("li",{className:"breadcrumb-item",children:e.jsx(u,{href:route("admin.coupons"),children:"Coupons"})}),e.jsx("li",{className:"breadcrumb-item active","aria-current":"page",children:s?"Edit Coupon":"Add Coupon"})]})}),e.jsxs("form",{onSubmit:p,autoComplete:"off",children:[e.jsxs("div",{className:"form-group row",children:[e.jsxs("label",{className:"col-sm-3 col-form-label",children:["Coupon Code ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs("div",{className:"col-sm-8",children:[e.jsx("input",{className:"form-control",type:"text",name:"code",id:"code",required:!0,value:l.code,onChange:d}),r.code&&e.jsx("span",{className:"text-danger",children:r.code}),e.jsx("br",{}),e.jsx("button",{type:"button",onClick:N,className:"btn btn-success",children:"Generate"})]})]}),e.jsxs("div",{className:"form-group row",children:[e.jsx("label",{className:"col-sm-3 col-form-label",children:"Coupon Value"}),e.jsxs("div",{className:"col-sm-6",children:[e.jsx("input",{className:"form-control",type:"number",name:"value",required:!0,value:l.value,onChange:d}),r.value&&e.jsx("span",{className:"text-danger",children:r.value})]}),e.jsxs("div",{className:"col-sm-2",children:[e.jsxs("select",{className:"form-control",name:"type",required:!0,value:l.type,onChange:d,children:[e.jsx("option",{value:"percent",children:"Percentage"}),e.jsx("option",{value:"fixed",children:"Fixed"})]}),r.type&&e.jsx("span",{className:"text-danger",children:r.type})]})]}),e.jsxs("div",{className:"form-group row",children:[e.jsxs("label",{className:"col-sm-3 col-form-label",children:["User Limit ",e.jsx("span",{className:"text-danger",children:"*"})]}),e.jsxs("div",{className:"col-sm-8",children:[e.jsx("input",{className:"form-control",type:"number",name:"usage_limit",required:!0,value:l.usage_limit,onChange:d}),r.usage_limit&&e.jsx("span",{className:"text-danger",children:r.usage_limit})]})]}),e.jsxs("div",{className:"form-group row",children:[e.jsx("label",{className:"col-sm-3 col-form-label",children:"Expiration Date"}),e.jsxs("div",{className:"col-sm-8",children:[e.jsx("input",{className:"form-control",type:"date",name:"exp_date",value:l.exp_date?l.exp_date.slice(0,10):"",onChange:d}),r.exp_date&&e.jsx("span",{className:"text-danger",children:r.exp_date})]})]}),e.jsxs("div",{className:"form-group row",children:[e.jsx("label",{className:"col-sm-3 col-form-label",children:"Status"}),e.jsxs("div",{className:"col-sm-8",children:[e.jsxs("select",{className:"form-control",name:"status",value:l.status,onChange:d,children:[e.jsx("option",{value:"1",children:"Active"}),e.jsx("option",{value:"2",children:"Inactive"})]}),r.status&&e.jsx("span",{className:"text-danger",children:r.status})]})]}),e.jsx("div",{className:"form-group row",children:e.jsx("div",{className:"col-sm-12 text-center",children:e.jsx("button",{type:"submit",className:"btn btn-primary",children:s?"Update":"Save"})})})]})]})]})};export{I as default};
