import{W as C,r as m,j as s,Y as L,y as P}from"./app-DWiplGih.js";import{s as j,a as M}from"./SweetAlert-_wzJVbyC.js";import{A as _}from"./AuthenticatedLayout-RN_dLH_b.js";import"./jquery-TLgHKWof.js";import"./bootstrap.esm-Bb0rKlaf.js";import"./Loder-D9bdZO9o.js";import"./MyImage-BxCI3zcA.js";function q({errors:N,smtp:d}){const{errors:g,setError:h,clearErrors:v,data:b,setData:S}=C(),[x,y]=m.useState(""),[u,n]=m.useState(""),[p,r]=m.useState(!1),o={...N,...g},l={...d,...b},w=e=>{n(""),y(e.target.value)},f=(e,t)=>{let a=!0;switch(e){case"test_email":/\S+@\S+\.\S+/.test(t)||(h(e,"Invalid email format."),a=!1);break;case"host":case"port":case"email":case"password":t.trim()||(h(e,`${e} is required.`),a=!1);break}return a&&v(e),a},c=e=>{const{name:t,value:a}=e.target;S(i=>({...i,[t]:a})),f(t,a)},E=async()=>{try{r(!0);const e=await axios.post(route("smtp.test"),{test_email:x});e.data.status=="success"&&(j(e.data.message),n(""),r(!1),$("#test_model").modal("hide")),e.data.status=="error"&&e.data.errors&&(console.log(e.data.errors),n(e.data.errors),r(!1))}catch(e){console.error(e)}finally{r(!1)}},T=async e=>{if(e.preventDefault(),Object.keys(l).every(a=>f(a,l[a]))){const a=d?"SMTP settings updated successfully":"SMTP settings created successfully";r(!0);try{await P.post(route("smtp.save"),{...l},{onSuccess:()=>{r(!1),j(a)}})}catch(i){console.error("Error submitting form:",i),M("An error occurred while submitting the form. Please try again.")}}};return s.jsx(s.Fragment,{children:s.jsxs(_,{isLoading:p,children:[s.jsx(L,{title:"SMTP Settings"}),s.jsxs("div",{className:"card-box",children:[s.jsxs("div",{className:"form-group row",children:[s.jsx("label",{className:"col-sm-2 col-form-label",children:" "}),s.jsx("div",{className:"col-sm-8",children:s.jsxs(Link,{href:"#",className:"btn btn-info btn-md pull-right","data-toggle":"modal","data-target":"#test_model",children:[s.jsx("i",{className:"fa fa-send"})," Test SMTP"]})}),s.jsx("div",{id:"test_model",className:"modal fade",tabIndex:"-1",role:"dialog",children:s.jsx("div",{className:"modal-dialog",children:s.jsxs("div",{className:"modal-content",children:[s.jsxs("div",{className:"modal-header",children:[s.jsx("h4",{className:"modal-title",children:"Test SMTP"}),s.jsx("button",{type:"button",className:"close","data-dismiss":"modal","aria-hidden":"true",children:"×"})]}),s.jsx("div",{className:"modal-body",children:s.jsxs("div",{className:"form-group row",children:[s.jsx("label",{className:"col-sm-3 col-form-label",children:"Test Email"}),s.jsxs("div",{className:"col-sm-9",children:[s.jsx("input",{type:"email",name:"test_email",placeholder:"Email",className:"form-control",value:x,onChange:w}),u&&s.jsx("span",{className:"text-danger",children:u})]})]})}),s.jsx("div",{className:"modal-footer",children:s.jsx("button",{className:"btn btn-primary",onClick:E,children:p?"Sending...":"Send"})})]})})})]}),s.jsxs("form",{onSubmit:T,children:[s.jsxs("div",{className:"form-group row",children:[s.jsx("label",{className:"col-sm-2 col-form-label",children:"Host *"}),s.jsxs("div",{className:"col-sm-8",children:[s.jsx("input",{type:"text",name:"host",className:"form-control",value:l.host||"",onChange:c}),o&&(o==null?void 0:o.host)&&s.jsx("span",{className:"text-danger",children:o.host})]})]}),s.jsxs("div",{className:"form-group row",children:[s.jsx("label",{className:"col-sm-2 col-form-label",children:"Port *"}),s.jsx("div",{className:"col-sm-8",children:s.jsx("input",{type:"text",name:"port",className:"form-control",value:l.port||"",onChange:c})})]}),s.jsxs("div",{className:"form-group row",children:[s.jsx("label",{className:"col-sm-2 col-form-label",children:"Email *"}),s.jsx("div",{className:"col-sm-8",children:s.jsx("input",{type:"email",name:"email",className:"form-control",value:l.email||"",onChange:c})})]}),s.jsxs("div",{className:"form-group row",children:[s.jsx("label",{className:"col-sm-2 col-form-label",children:"Password *"}),s.jsx("div",{className:"col-sm-8",children:s.jsx("input",{type:"password",name:"password",className:"form-control",value:l.password||"",onChange:c})})]}),s.jsxs("div",{className:"form-group row",children:[s.jsx("label",{className:"col-sm-2 col-form-label",children:"Encryption"}),s.jsx("div",{className:"col-sm-8",children:s.jsxs("select",{name:"encryption",className:"form-control",value:l.encryption||"SSL",onChange:c,children:[s.jsx("option",{value:"TLS",children:"TLS"}),s.jsx("option",{value:"SSL",children:"SSL"})]})})]}),s.jsx("div",{className:"form-group",children:s.jsx("div",{className:"col-sm-8 offset-sm-2",children:s.jsx("button",{type:"submit",className:"btn btn-primary",children:"Save Settings"})})})]})]})]})})}export{q as default};
